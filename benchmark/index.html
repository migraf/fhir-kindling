
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../transfer/">
      
      
        <link rel="next" href="../ds/">
      
      <link rel="icon" href="../assets/logo.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Server Benchmarking - FHIR Kindling</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#benchmarking" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="FHIR Kindling" class="md-header__button md-logo" aria-label="FHIR Kindling" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FHIR Kindling
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Server Benchmarking
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/migraf/fhir-kindling" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="FHIR Kindling" class="md-nav__button md-logo" aria-label="FHIR Kindling" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    FHIR Kindling
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/migraf/fhir-kindling" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../connect/" class="md-nav__link">
        Connect to a FHIR server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../query/" class="md-nav__link">
        Query a server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add/" class="md-nav__link">
        Add resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../delete/" class="md-nav__link">
        Delete resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../update/" class="md-nav__link">
        Update resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../transfer/" class="md-nav__link">
        Transfer resources
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Server Benchmarking
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Server Benchmarking
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-preconfigured-benchmarks" class="md-nav__link">
    Run preconfigured benchmarks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-the-benchmark" class="md-nav__link">
    Configuring the benchmark
  </a>
  
    <nav class="md-nav" aria-label="Configuring the benchmark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#size-and-number-of-attempts" class="md-nav__link">
    Size and number of attempts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steps-and-custom-queries" class="md-nav__link">
    Steps and custom queries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    API Reference
  </a>
  
    <nav class="md-nav" aria-label="API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fhir_kindling.benchmark.bench.ServerBenchmark" class="md-nav__link">
    fhir_kindling.benchmark.bench.ServerBenchmark
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fhir_kindling.benchmark.bench.ServerBenchmark.results" class="md-nav__link">
    results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fhir_kindling.benchmark.bench.ServerBenchmark.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fhir_kindling.benchmark.bench.ServerBenchmark.plot" class="md-nav__link">
    plot()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fhir_kindling.benchmark.bench.ServerBenchmark.run_suite" class="md-nav__link">
    run_suite()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ds/" class="md-nav__link">
        Data Science
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        API docs
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-preconfigured-benchmarks" class="md-nav__link">
    Run preconfigured benchmarks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-the-benchmark" class="md-nav__link">
    Configuring the benchmark
  </a>
  
    <nav class="md-nav" aria-label="Configuring the benchmark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#size-and-number-of-attempts" class="md-nav__link">
    Size and number of attempts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steps-and-custom-queries" class="md-nav__link">
    Steps and custom queries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    API Reference
  </a>
  
    <nav class="md-nav" aria-label="API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fhir_kindling.benchmark.bench.ServerBenchmark" class="md-nav__link">
    fhir_kindling.benchmark.bench.ServerBenchmark
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fhir_kindling.benchmark.bench.ServerBenchmark.results" class="md-nav__link">
    results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fhir_kindling.benchmark.bench.ServerBenchmark.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fhir_kindling.benchmark.bench.ServerBenchmark.plot" class="md-nav__link">
    plot()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fhir_kindling.benchmark.bench.ServerBenchmark.run_suite" class="md-nav__link">
    run_suite()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="benchmarking">Benchmarking</h1>
<p>Fhir kindling provides tooling to run reproducible benchmarks against FHIR servers.
The benchmark cover common CRUD operations as well as FHIR search requests with increasing complexities.
To perform these tests the benchmarking tool creates a synthetic dataset with configurable size that is used to populate the server.
The benchmarking tool then performs the operations against the server and records the time it took to complete each operation.
Dataset size and the number of attempts made for each step in the benchmark can be configured.</p>
<p>After the benchmark is successfully run the the results are stored as a JSON file and also plotted as a graph and saved as a PNG file.</p>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li><a href="https://docs.docker.com/get-docker/">Docker</a>(for preconfigured benchmarks)</li>
<li>Fhir kindling installed</li>
</ul>
<h2 id="run-preconfigured-benchmarks">Run preconfigured benchmarks</h2>
<p>To easily test how the most common fhir implementations perform on your machine you can use the preconfigured benchmarks.</p>
<p>First clone the repository on the machine you want to run the benchmarks on.
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/migraf/fhir-kindling.git
</code></pre></div>
The <code>benchmarks</code> directory contains a <code>docker-compose.yml</code> file that starts a Blaze, HAPI, and Linux4Health FHIR server.
Start the servers using docker compose
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div></p>
<p>If not already installed, install <code>fhir-kindling</code> with the ds extras
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>fhir-kindling<span class="o">[</span>ds<span class="o">]</span>
</code></pre></div></p>
<p>Or install using poetry (recommended) in the root directory of the repository
<div class="highlight"><pre><span></span><code>poetry<span class="w"> </span>install<span class="w"> </span>--extras<span class="w"> </span>ds
</code></pre></div></p>
<p>These servers are configured by default in the <code>benchmark_servers.py</code> script. If you want to add your own server, you can do so by adding it to the <code>servers</code> list in the script.</p>
<p>Run the benchmark script
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>benchmark_servers.py
</code></pre></div></p>
<h2 id="configuring-the-benchmark">Configuring the benchmark</h2>
<p>There are multiple configuration options to adapt the benchmark to your needs.</p>
<ul>
<li>You can modify the number of resources and attempts the benchmark makes.</li>
<li>You can select which steps to run in case you dont want to run the full suite</li>
<li>You can add your own custom search queries to be evaluated against the servers</li>
</ul>
<h3 id="size-and-number-of-attempts">Size and number of attempts</h3>
<p>Modify the dataset size and the number of attempts made for each step in the benchmark by settings the <code>dataset_size</code> and <code>n_attempts</code> variables on the <code>ServerBenchmark</code> instance. (Keep in mind that the dataset size changes with approximately a factor of 10 based on the parameter given in the <code>dataset_size</code> variable.)</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">fhir_kindling</span> <span class="kn">import</span> <span class="n">FhirServer</span>
<span class="kn">from</span> <span class="nn">fhir_kindling.benchmark</span> <span class="kn">import</span> <span class="n">ServerBenchmark</span>

<span class="n">servers</span> <span class="o">=</span> <span class="p">[</span><span class="n">FhirServer</span><span class="p">(</span><span class="n">api_adress</span><span class="o">=</span><span class="s2">&quot;http://localhost:9090/fhir&quot;</span><span class="p">)</span><span class="s2">&quot;)]</span>
<span class="n">benchmark</span> <span class="o">=</span> <span class="n">ServerBenchmark</span><span class="p">(</span>
    <span class="n">servers</span><span class="o">=</span><span class="n">servers</span><span class="p">,</span>
    <span class="n">dataset_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">n_attempts</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="steps-and-custom-queries">Steps and custom queries</h3>
<p>By passing a list of steps (<code>generate</code>, <code>query</code>, <code>insert</code>, <code>dataset_insert</code>, <code>update</code>, <code>delete</code>) to the <code>steps</code> parameter you can select which steps to run in the benchmark.
You can run your own queries by passing either FHIR REST query strings or <code>FhirQueryParameter</code> objects to the <code>custom_queries</code> parameter.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">fhir_kindling</span> <span class="kn">import</span> <span class="n">FhirServer</span>
<span class="kn">from</span> <span class="nn">fhir_kindling.benchmark</span> <span class="kn">import</span> <span class="n">ServerBenchmark</span>

<span class="n">servers</span> <span class="o">=</span> <span class="p">[</span><span class="n">FhirServer</span><span class="p">(</span><span class="n">api_adress</span><span class="o">=</span><span class="s2">&quot;http://localhost:9090/fhir&quot;</span><span class="p">)</span><span class="s2">&quot;)]</span>
<span class="n">benchmark</span> <span class="o">=</span> <span class="n">ServerBenchmark</span><span class="p">(</span>
    <span class="n">servers</span><span class="o">=</span><span class="n">servers</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;generate&quot;</span><span class="p">,</span> <span class="s2">&quot;dataset_insert&quot;</span><span class="p">,</span> <span class="s2">&quot;query&quot;</span><span class="p">],</span>
    <span class="n">custom_queries</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Condition?_count=1000&quot;</span><span class="p">,</span> <span class="s2">&quot;Observation?_count=10000&quot;</span><span class="p">],</span>
<span class="p">)</span>
</code></pre></div>
<h2 id="api-reference">API Reference</h2>


  <div class="doc doc-object doc-class">

<a id="fhir_kindling.benchmark.bench.ServerBenchmark"></a>
    <div class="doc doc-contents first">





  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="fhir_kindling.benchmark.bench.ServerBenchmark.results" class="doc doc-heading">
<code class="highlight language-python"><span class="n">results</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Retunrs the results of the benchmark if the benchmark has completed.</p>

<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>If the benchmark has not completed</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>The results of the benchmark</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>






  <div class="doc doc-object doc-method">



<h3 id="fhir_kindling.benchmark.bench.ServerBenchmark.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">servers</span><span class="p">,</span> <span class="n">server_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_attempts</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dataset_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">custom_queries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize a benchmark object to test the performance of a set of servers.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>servers</code></td>
        <td><code>List[fhir_kindling.fhir_server.fhir_server.FhirServer]</code></td>
        <td><p>List of servers to benchmark.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>server_names</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>Optionally provide a list of names for the servers. Which will be used in the results.
Defaults to the servers api address.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_attempts</code></td>
        <td><code>int</code></td>
        <td><p>The number of attempts for each operation. Defaults to N_ATTEMPTS.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>batch_size</code></td>
        <td><code>int</code></td>
        <td><p>The size of the batches for evaluating batch operations. Defaults to BATCH_SIZE.</p></td>
        <td><code>100</code></td>
      </tr>
      <tr>
        <td><code>dataset_size</code></td>
        <td><code>int</code></td>
        <td><p>The number of base resources in the dataset. Defaults to 1000.</p></td>
        <td><code>1000</code></td>
      </tr>
      <tr>
        <td><code>custom_queries</code></td>
        <td><code>Optional[List[Tuple[str, Union[str, fhir_kindling.fhir_query.query_parameters.FhirQueryParameters]]]]</code></td>
        <td><p>A list of custom FHIR search queries to be included in the benchmark. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>steps</code></td>
        <td><code>List[Union[str, fhir_kindling.benchmark.constants.BenchmarkOperations]]</code></td>
        <td><p>Select a subset of the steps to run. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the number of server names does not match the number of servers.</p></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="fhir_kindling.benchmark.bench.ServerBenchmark.plot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Plot the results of the benchmark</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>The plotly figure displaying the results</p></td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="fhir_kindling.benchmark.bench.ServerBenchmark.run_suite" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_suite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">results_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Run the the test suite configured for this benchmark instance.
By default the steps are: Dataset generation, single resource insert, batch insert,
dataset upload, search, update and delete.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>progress</code></td>
        <td><code>bool</code></td>
        <td><p>Wether to visualize progress using a progress bar. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>save</code></td>
        <td><code>bool</code></td>
        <td><p>Save the results to file once the suite is finished. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>results_dir</code></td>
        <td><code>str</code></td>
        <td><p>Directory in which to save the results. If None defaults to current working directory.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>





  </div>

    </div>

  </div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.expand", "content.code.copy"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>